# （不知道怎么贡献到贝贝羊的那个主分支，代码目前只传到了这个fork里）

# 新增与优化
修复空格拖动功能。
优化性能参数，如配置不够可以增加数值降低负载。

新增像素点学习功能，Q取色时会自动截图并进行小像素点的学习，判定大小像素点。

<img width="300" height="196" alt="20251005_093237_small_100area_11x11" src="https://github.com/user-attachments/assets/7cc9c2ed-389c-4ff9-b01e-e07f5997b6f5" />

新增扫描模式，默认运行状态下，不会进行图片保存，按X可以手动截图，在脚本目录的SCANS文件夹查看目前屏幕的已识别小像素点，绿：已识别的小像素点；红：所有被扫描到的像素位置；黄：被忽略的区域。

<img width="3458" height="1213" alt="debug_scan_20251005_094647_309390" src="https://github.com/user-attachments/assets/8b0213b3-91ca-4877-9b96-8f1bda563b62" />

改进忽略区域使用方法，首次按H键读取鼠标坐标，再次按H键读取鼠标坐标，并生成忽略区域。

新增像素阈值快捷键：[ 和 ] ，左方和右方，用来增减像素阈值，提高未填色小像素点的判定标准。基本使用默认数值即可。

新增调试模式快捷键T，启用后热切换调试模式，只进行鼠标移动，而不进行填色操作，用于调试。

新增拖动功能快捷键Z。

现在脚本应该很好用了。

# 一些使用技巧
地图不需要拉的很近，拉远一点效果也很好。绿色代表已识别。
<img width="1475" height="999" alt="屏幕截图 2025-10-06 024919" src="https://github.com/user-attachments/assets/f2e194c5-8218-4ca6-9fd8-a1de449feb84" />
<img width="1530" height="1045" alt="屏幕截图 2025-10-06 024909" src="https://github.com/user-attachments/assets/150074a1-c803-49ae-bb1a-b15c79854465" />

像素阈值基本上不需要修改，默认即可。
地图拉远后空格拖动出现错误拖动，尝试在代码中修改连续的距离阈值，我的设置是35。
对于边界颜色会变淡一点的像素点，可以Q重新采色，然后W填色。
安装完python后可以右键脚本，选择打开方式→python（始终打开），下次直接双击就可以运行脚本了。

应该没什么问题了，有问题可以在超级气球群@小小TK

### 1. 环境准备

在运行脚本之前，请确保您已安装所需的 Python 库。可以使用以下命令一键安装：

```bash
pip install pyautogui numpy opencv-python pygetwindow pynput scikit-learn pywin32
```



### 2. 启动脚本

安装完所有依赖后，只需在终端中运行主程序：

```
python main.py
```

------

# 纯新
安装python。我的python版本是3.10.安装教程请自行搜索。

https://www.python.org/downloads/


安装需要的库。
```bash
pip install pyautogui
pip install opencv-python
pip install numpy
pip install pygetwindow
pip install pynput
pip install scikit-learn
```

之后就可以正常运行脚本了。

## 使用指南



### 1. 热键操作

- **W**: **启动/暂停** 绘画。按下启动，再次按下暂停。
- **Q**: **拾取颜色**。将鼠标悬停在您想要填色的 Blue Marble 小格上，或调色板内的颜色上，按下Q键即可将该颜色设为新的目标颜色，并自动保存到配置文件中。
- **H-H**: **定义并保存矩形忽略区域**。  - 将鼠标移动到您想要忽略的区域的**左上角**，按一次 **H**。  - 将鼠标移动到该区域的**右下角**，再按一次 **H**。自动保存本次忽略区域，脚本将不再处理该区域内的像素，例如左上角的大小缩放、twitch小图标，Blue Marble窗口，下方的颜色选框。
- **G**: **立即停止** 脚本。该操作等同于在终端窗口中按下 `Ctrl + C`，能够立即终止脚本的运行。
- **Z**: **调试模式** 只进行鼠标移动，不进行点击。
- **X**: **扫描模式手动截图** 手动截图，在脚本目录里查看像素点的识别信息。
- **T**: **启停空格拖动功能** 启停——————————
- **[ ]**: **增大、减小像素点判定阈值** ————————————
------



### 2. 文件说明

- `main.py`: 脚本主程序。
- `exclusion_zones.txt`: 配置文件。脚本启动时会自动创建或加载此文件。它用于保存您设置的忽略区域坐标和上次拾取的**目标颜色**。这使得您下次运行脚本时，无需重新配置即可继续使用。

------



### 3. 注意事项

- 此脚本基于 **Blue Marble** 功能设计，使用时请确保打开了 Wplace 窗口并已经安装了 **Blue Marble** 插件。
- 对于已经被涂上错误颜色的色块，脚本可能无法很好地识别并进行修正。正在考虑在未来的版本中改进此功能。




